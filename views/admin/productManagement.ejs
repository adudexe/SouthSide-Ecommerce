<%- include("../partials/admin/header.ejs") %>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

<section class="content-main">
    <div class="content-header">
        <div>
            <h2 class="content-title card-title">Products List</h2>
        </div>
        <div>
            <a href="/admin/addProduct" class="btn btn-primary btn-sm rounded">Add New Product</a>
        </div>
    </div>
    <!-- <p><%= //products %></p> -->
    <div class="card mb-4" id="productCard">
        <header class="card-header">
            <div class="row align-items-center">
                <div class="col-lg-4 col-sm-4 col-8 flex-grow-1 col-name">
                    <a class="itemside" href="#">
                        <div class="left">
                            <h6 class="mb-0">Product Image</h6>
                        </div>
                        <div class="info">
                            <h6 class="mb-0 ms-3">Product Name</h6>
                        </div>
                    </a>
                </div>
                <div class="col-lg-2 col-sm-2 col-4 col-price">Price</div>
                <div class="col-lg-1 col-sm-2 col-4 col-date">
                    <span>Date</span>
                </div>
                <div class="col-lg-2 col-sm-2 col-4 col-action text-end">
                    <h6 class="mb-0">Options</h6>
                </div>
            </div>
        </header>
        <div class="card-body" id="card-body">
            <% let count=0; %>
                <% products.forEach(element => { %>
                    <% if (!element.isDeleted) { %>
                        <% count++; %>
                        <article class="itemlist">
                            <div class="row align-items-center">
                                <div class="col-lg-4 col-sm-4 col-8 flex-grow-1 col-name">
                                    <a class="itemside" href="#">
                                        <div class="left">
                                            <img src="/<%= element.productImages[0] %>" class="img-sm img-thumbnail" alt="Item">
                                        </div>
                                        <div class="info">
                                            <h6 class="mb-0 ms-5"><%= element.productName %></h6>
                                        </div>
                                    </a>
                                </div>
                                <div class="col-lg-2 col-sm-2 col-4 col-price">
                                    <span>$<%= element.variants[0].price %></span>
                                </div>
                                <div class="col-lg-1 col-sm-2 col-4 col-date">
                                    <span><%= element.createdAt.toLocaleDateString('en-GB') %></span>
                                </div>
                                <div class="col-lg-2 col-sm-2 col-4 col-action text-end">
                                    <a href="/admin/products/edit/<%= element._id %>" class="btn btn-sm font-sm rounded btn-brand">Edit</a>
                                    <a class="btn btn-sm font-sm btn-light rounded delete-btn" data-id="<%= element._id %>">Delete</a>
                                    <a href="#" class="btn btn-sm btn-danger rounded" data-id="<%=element._id%>">Block</a>
                                </div>
                            </div>
                        </article>
                    <% } %>
                <% }) %>
                <% if (count==0) { %>
                    <p>No Products Found</p>
                <% } %>
        </div>
    </div>

    <!-- Pagination -->
    <div class="pagination-area mt-30 mb-50">
        <nav aria-label="Page navigation example">
            <ul class="pagination justify-content-start">
                <% if (currentPage > 1) { %>
                    <li class="page-item"><a class="page-link" href="?page=<%= currentPage - 1 %>"><</a></li>
                <% } %>

                <% for (let i = 1; i <= totalPages; i++) { %>
                    <li class="page-item <%= i === currentPage ? 'active' : '' %>">
                        <a class="page-link" href="?page=<%= i %>"><%= i %></a>
                    </li>
                <% } %>

                <% if (currentPage < totalPages) { %>
                    <li class="page-item"><a class="page-link" href="?page=<%= currentPage + 1 %>">></a></li>
                <% } %>
            </ul>
        </nav>
    </div>
</section>

<footer class="main-footer font-xs">
    <div class="row pb-30 pt-15">
        <div class="col-sm-6">
            <script>
                // document.write(new Date().getFullYear())
            </script> Â©, Evara - HTML Ecommerce Template.
        </div>
        <div class="col-sm-6">
            <div class="text-sm-end">
                All rights reserved
            </div>
        </div>
    </div>
</footer>

<!-- JS Scripts -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="assets/js/vendors/jquery-3.6.0.min.js"></script>
<script src="assets/js/vendors/bootstrap.bundle.min.js"></script>

<script src="/admin/assets/js/deleteProduct.js"></script>

<script src="/admin/assets/js/vendors/jquery-3.6.0.min.js"></script>
<script src="/admin/assets/js/vendors/bootstrap.bundle.min.js"></script>
<script src="/admin/assets/js/vendors/select2.min.js"></script>
<script src="/admin/assets/js/vendors/perfect-scrollbar.js"></script>
<script src="/admin/assets/js/vendors/jquery.fullscreen.min.js"></script>
<!-- Main Script -->
<script src="/admin/assets/js/main.js" type="text/javascript"></script>
<!-- JS Scripts -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="http://localhost:3000/admin/assets/js/vendors/jquery-3.6.0.min.js"></script>
<script src="http://localhost:3000/admin/assets/js/vendors/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/cropperjs@1.5.12/dist/cropper.min.js"></script>

</body>

</html>
